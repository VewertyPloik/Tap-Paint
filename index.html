<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tap-to-Paint â€” 20 Picture Pack</title>
  <style>
    :root{
      --bg:#0f172a; /* slate-900 */
      --panel:#111827; /* gray-900 */
      --card:#0b1220; /* deep panel */
      --ink:#e5e7eb; /* gray-200 */
      --accent:#7c3aed; /* violet-600 */
      --muted:#94a3b8; /* slate-400 */
      --good:#22c55e; /* green-500 */
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu; background:linear-gradient(180deg,#0b1220,#0a0f1a 60%); color:var(--ink)}
    header{position:sticky;top:0;z-index:5;background:rgba(10,15,26,.7);backdrop-filter:blur(10px);padding:14px 16px;border-bottom:1px solid #1f2937;display:flex;align-items:center;gap:12px}
    header h1{font-size:18px;margin:0}
    header .spacer{flex:1}
    header button{background:var(--accent);color:white;border:none;border-radius:12px;padding:10px 14px;font-weight:600;cursor:pointer;box-shadow:0 6px 18px rgba(124,58,237,.35)}
    header button[hidden]{display:none}

    #menu{padding:18px; display:grid; grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:14px;}
    .card{background:var(--card);border:1px solid #1f2937;border-radius:14px; padding:10px; cursor:pointer; transition:.2s transform, .2s box-shadow}
    .card:hover{transform:translateY(-2px); box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .thumb{width:100%; aspect-ratio:1/1; border-radius:10px; display:block; background:#0a0f1a; border:1px solid #1f2937}
    .label{margin-top:8px; font-size:14px; color:var(--muted); display:flex; align-items:center; justify-content:space-between; gap:8px}
    .done{color:var(--good); font-weight:700}

    #game{display:none; padding:18px}
    #title{margin:8px 0 2px 0}
    #hint{color:var(--muted); font-size:14px}

    #grid{display:grid; justify-content:center; gap:2px; margin:16px auto}
    .cell{width:min(7.5vw,30px); height:min(7.5vw,30px); background:#111827; border-radius:6px; border:1px solid #1f2937;}

    .toolbar{display:flex; gap:10px; justify-content:center; margin-top:10px}
    .pill{border:1px solid #1f2937; background:#0b1220; color:var(--ink); border-radius:999px; padding:8px 12px; font-size:14px}
  </style>
</head>
<body>
  <header>
    <h1>ðŸŽ¨ Tapâ€‘toâ€‘Paint</h1>
    <div class="spacer"></div>
    <button id="backBtn" hidden>â¬… Back to Menu</button>
  </header>

  <main id="menu"></main>

  <section id="game">
    <h2 id="title"></h2>
    <div id="hint">Tap anywhere â€” the game paints 2â€“4 correct tiles for you automatically.</div>
    <div id="grid"></div>
    <div class="toolbar">
      <span class="pill" id="progressPill">0% complete</span>
      <button class="pill" id="resetBtn">Reset this painting</button>
    </div>
  </section>

<script>
// --- Color palette (single-letter keys used in ASCII art) ---
const C = {
  r:'#ef4444', // red
  p:'#ff6b81', // pink
  y:'#facc15', // yellow
  o:'#fb923c', // orange
  g:'#22c55e', // green
  b:'#3b82f6', // blue
  u:'#06b6d4', // cyan/teal
  v:'#8b5cf6', // violet
  w:'#e5e7eb', // white
  k:'#0f172a', // near-black
  n:'#8d5524', // brown
  s:'#94a3b8', // gray/silver
};

// Helper to convert ASCII art into a color grid
function gridFromArt(lines, map=C){
  const rows = lines.trim().split(/\n+/).map(l=>l.trim());
  const h = rows.length, w = rows[0].length;
  return rows.map(row => [...row].map(ch => ch==='.'? null : (map[ch]||null)));
}

// 20 custom 12x12 designs â€” all made here
const patterns = {
  Rose: gridFromArt(`
....pppp....
...prrrp...
..prrrrpp..
..prrrrrp..
...prrrp...
....ppp....
.....g.....
.....g.....
.....g.....
....ggg....
....ggg....
.....g.....
`),
  Sun: gridFromArt(`
..y..y..y..
..yyyyyy..
.yyyyyyyy.
.yyyyyyyy.
.yyyyyyyy.
..yyyyyy..
..y..y..y..
....y.y....
..........
..........
..........
..........
`),
  Rainbow: gridFromArt(`
..rrrrrrrr..
..oooooooo..
..yyyyyyyy..
..gggggggg..
..bbbbbbbb..
..vvvvvvvv..
............
............
............
............
............
............
`),
  'Soccer Ball': gridFromArt(`
....wwww....
..wwkkkkww..
.wwkwkkwkww.
.wwkkkkkkww.
.wwkwkkwkww.
..wwkkkkww..
....wwww....
............
............
............
............
............
`),
  Basketball: gridFromArt(`
....oooooooo
...oooooooo.
..oooookooo.
..ooookoooo.
..oookooooo.
..ooookoooo.
..oooookooo.
...oooooooo.
....oooooooo
............
............
............
`),
  Heart: gridFromArt(`
..rr..rr..
.rrrrrrrr.
rrrrrrrrrr
rrrrrrrrrr
.rrrrrrrr.
..rrrrrr..
...rrrr...
....rr....
....rr....
............
............
............
`),
  Tree: gridFromArt(`
....gggg....
...gggggg...
..gggggggg..
...gggggg...
....gggg....
.....gg.....
.....gg.....
.....gg.....
.....gg.....
.....nn.....
.....nn.....
.....nn.....
`),
  Star: gridFromArt(`
.....y.....
.....y.....
..yyyyyyyy..
...yyyyyy...
....yyyy....
.yyyyyyyyyy.
....yyyy....
...yyyyyy...
..yyyyyyyy..
.....y.....
.....y.....
............
`),
  House: gridFromArt(`
.....r.....
....rrr....
...rrrrr...
..rrrrrrr..
..nnnnnnn..
..nwwnwwn..
..nwwnwwn..
..nkkkkkn..
..nkkkkkn..
..nnnnnnn..
....nnn....
............
`),
  Fish: gridFromArt(`
.....bbbb..
...bbbbbbb.
..bbbbbbbb.
.bbbbbbbbb.
..bbbbbbbb.
...bbbbbbb.
.....bbbb..
....u..u...
............
............
............
............
`),
  Bird: gridFromArt(`
....bbbb....
...bbbbbb...
..bbbbbbbb..
..bbbbbbbb..
....bbbb....
.....bb.....
..w..bb..w..
.....bb.....
....bbbb....
............
............
............
`),
  Cat: gridFromArt(`
..nn....nn..
.nnnn..nnnn.
.nnnnnnnnnn.
.nw.nnn.nw..
.nnnnnnnnnn.
..nnnkkknn..
...nnnnnn...
....n..n....
...k....k...
....kkkk....
............
............
`),
  Dog: gridFromArt(`
..nnnnnnnn..
.nnnnnnnnnn.
.nw..nn..w..
.nnnnnnnnnn.
..nnnkkknn..
...nnnnnn...
...n....n...
...k....k...
....kkkk....
.....nn.....
............
............
`),
  Flower: gridFromArt(`
.....p.....
....ppp....
...ppppp...
....py p...
.....y.....
.....g.....
.....g.....
....ggg....
....ggg....
.....g.....
............
............
`),
  Car: gridFromArt(`
............
...rrrrrr...
..rrrrrrrr..
..rrrrrrrr..
..rrrrrrrr..
.nnnnnnnnnn.
.nw..nn..wn.
.nw..nn..wn.
.nnnnnnnnnn.
............
............
............
`),
  Boat: gridFromArt(`
.....w......
.....w......
.....w......
.....w......
.....w......
.....w......
..vvvvvvvv..
.nnnnnnnnnn.
.bbbbbbbbbb.
.bbbbbbbbbb.
............
............
`),
  Moon: gridFromArt(`
....yyyy....
...yyyyyy...
..yyyyyyyy..
..yyyyy.....
..yyyy......
...yyy......
....yy......
.....y......
............
............
............
............
`),
  Cloud: gridFromArt(`
............
....wwww....
..wwwwwwww..
.wwwwwwwwww.
..wwwwwwww..
....wwww....
............
............
............
............
............
............
`),
  Mountain: gridFromArt(`
....ss......
...sss......
..sssss..ss.
.ssssss.sss.
ssssssssssss
ssswwsssssww
sswwwwssswww
swwwwwswwwww
swwwwwwwwwww
wwwwwwwwwwww
............
............
`),
  Smiley: gridFromArt(`
..yyyyyyyy..
.yyyyyyyyyy.
.ywyyyyyywy.
.yyyyyyyyyy.
.yykkkkkkyy.
.yyyyyyyyyy.
.ywyyyyyywy.
.yyyyyyyyyy.
..yyyyyyyy..
............
............
............
`),
};

// Build paintings list with titles in a fixed order
const TITLES = [
  'Rose','Sun','Rainbow','Soccer Ball','Basketball','Heart','Tree','Star','House','Fish','Bird','Cat','Dog','Flower','Car','Boat','Moon','Cloud','Mountain','Smiley'
];

const paintings = TITLES.map(t => ({ title:t, grid:patterns[t], done:false }));

// --- Local save (done flags) ---
const SAVE_KEY = 'tap_painting_pack_v3';
function save(){ localStorage.setItem(SAVE_KEY, JSON.stringify(paintings.map(p=>p.done))); }
function load(){ const d = localStorage.getItem(SAVE_KEY); if(!d) return; try{ const arr = JSON.parse(d); arr.forEach((v,i)=> paintings[i] && (paintings[i].done = !!v)); }catch(_){} }

// --- UI: Menu ---
const menuEl = document.getElementById('menu');
const backBtn = document.getElementById('backBtn');
const gameEl = document.getElementById('game');
const titleEl = document.getElementById('title');
const gridEl = document.getElementById('grid');
const progEl = document.getElementById('progressPill');
const resetBtn = document.getElementById('resetBtn');

function renderMenu(){
  menuEl.innerHTML = '';
  paintings.forEach((p, idx)=>{
    const card = document.createElement('div');
    card.className = 'card';
    card.addEventListener('click', ()=> start(idx));

    const cv = document.createElement('canvas');
    cv.width = 200; cv.height = 200; cv.className = 'thumb';
    const ctx = cv.getContext('2d');
    const h = p.grid.length, w = p.grid[0].length;
    const s = Math.floor(180/Math.max(h,w));
    ctx.fillStyle = '#0a0f1a'; ctx.fillRect(0,0,cv.width,cv.height);
    for(let y=0;y<h;y++) for(let x=0;x<w;x++){
      const col = p.grid[y][x];
      if(!col) continue; ctx.fillStyle = col; ctx.fillRect(10 + x*s, 10 + y*s, s-1, s-1);
    }

    const label = document.createElement('div'); label.className = 'label';
    const name = document.createElement('span'); name.textContent = p.title;
    const check = document.createElement('span'); check.textContent = p.done? 'âœ…' : '';
    if(p.done) check.className = 'done';

    label.appendChild(name); label.appendChild(check);
    card.appendChild(cv); card.appendChild(label);
    menuEl.appendChild(card);
  });
}

// --- Game painting logic ---
let state = null; // {index, coords, painted, ptr}

function start(i){
  const p = paintings[i];
  backBtn.hidden = false; gameEl.style.display='block'; menuEl.style.display='none';
  titleEl.textContent = p.title;

  // Build list of target coordinates to paint
  const H = p.grid.length, W = p.grid[0].length;
  const coords = [];
  for(let y=0;y<H;y++) for(let x=0;x<W;x++) if(p.grid[y][x]) coords.push([y,x]);

  // Prepare DOM grid
  gridEl.innerHTML=''; gridEl.style.gridTemplateColumns = `repeat(${W}, min(7.5vw,30px))`;
  gridEl.style.gridTemplateRows = `repeat(${H}, min(7.5vw,30px))`;

  const cells = [];
  for(let y=0;y<H;y++) for(let x=0;x<W;x++){
    const div = document.createElement('div');
    div.className='cell';
    gridEl.appendChild(div); cells.push(div);
  }

  const painted = Array.from({length:H},()=>Array(W).fill(false));
  const total = coords.length; let paintedCount = 0; updateProgress();

  function paintBatch(){
    // Batch size 2-4 tiles per tap
    let batch = 2 + Math.floor(Math.random()*3); // 2,3,4
    for(let k=0;k<coords.length && batch>0;k++){
      const [y,x] = coords[k];
      if(painted[y][x]) continue;
      painted[y][x] = true; paintedCount++;
      const idx = y*W + x; cells[idx].style.background = p.grid[y][x]; cells[idx].style.borderColor = p.grid[y][x];
      batch--;
    }
    updateProgress();
    if(paintedCount===total){
      paintings[i].done = true; save();
      setTimeout(()=>{ alert('Painting complete!'); backToMenu(); }, 50);
    }
  }

  // Tap anywhere to paint next batch
  gridEl.onclick = paintBatch;
  document.body.onclick = (e)=>{ if(gameEl.style.display==='block' && e.target===gameEl) paintBatch(); };

  resetBtn.onclick = ()=>{
    for(let y=0;y<H;y++) for(let x=0;x<W;x++){
      painted[y][x]=false; const idx=y*W+x; cells[idx].style.background=''; cells[idx].style.borderColor='#1f2937';
    }
    paintings[i].done=false; save(); paintedCount=0; updateProgress();
  };

  function updateProgress(){
    const pct = Math.round(100*paintedCount/total);
    progEl.textContent = `${pct}% complete`;
  }
}

function backToMenu(){
  gameEl.style.display='none'; menuEl.style.display='grid'; backBtn.hidden = true; renderMenu();
}

backBtn.addEventListener('click', backToMenu);

// init
load(); renderMenu();
</script>
</body>
</html>
